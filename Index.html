<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Sigit Store - Katalog</title>
  <style>
    :root{--bg:#f5f7fa;--card:#fff;--primary:#6366f1;--text:#1f2d3a;--muted:#6e7a89;--radius:1rem;--shadow:0 20px 40px -10px rgba(0,0,0,0.1);}
    [data-theme=dark]{--bg:#0f172a;--card:#1f233f;--text:#e3e8ff;--muted:#94a3b8;}
    *{box-sizing:border-box;}
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;background:var(--bg);color:var(--text);}
    .container{max-width:1120px;margin:0 auto;padding:2rem 1rem;}
    .flex{display:flex;gap:1rem;align-items:center;}
    .btn{padding:.6rem 1.2rem;border:none;border-radius:.75rem;background:var(--primary);color:#fff;cursor:pointer;font-weight:600;}
    .card{background:var(--card);border-radius:var(--radius);padding:1rem;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:.5rem;}
    .product-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem;margin-top:1rem;}
    .price{font-weight:700;margin:0;}
    .small{font-size:.75rem;color:var(--muted);}
    img{border-radius:.75rem;object-fit:cover;}
    .search-bar input{width:100%;padding:.7rem 1rem;border-radius:999px;border:2px solid rgba(100,100,125,0.15);outline:none;}
    .tag{background:rgba(99,102,241,0.1);padding:4px 10px;border-radius:6px;font-size:.65rem;cursor:pointer;display:inline-block;margin-right:4px;}
    .dark-toggle{position:fixed;bottom:1rem;right:1rem;background:var(--card);border:none;border-radius:50%;padding:.65rem;cursor:pointer;box-shadow:0 20px 50px -10px rgba(0,0,0,0.2);}
    a{color:inherit;text-decoration:none;}
  </style>
</head>
<body data-theme="light">
  <header class="container">
    <div class="flex" style="justify-content:space-between;">
      <div style="font-weight:700;font-size:1.25rem;">Sigit Store</div>
      <div class="flex" style="gap:8px;">
        <input id="search" placeholder="Cari..." aria-label="Cari produk" style="padding:.6rem 1rem;border-radius:999px;border:2px solid rgba(100,100,125,0.15);"/>
        <a href="cart.html"><button class="btn" id="cartBtn">Keranjang (0)</button></a>
        <a href="admin.html"><button class="btn" style="background:#10b981;">Admin</button></a>
      </div>
    </div>
  </header>

  <main class="container" aria-label="Katalog produk">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div><h2 style="margin:0;">Produk</h2><div class="small">Tambah ke keranjang lalu lanjut ke keranjang.</div></div>
      <div>
        <span class="tag" data-filter="all">Semua</span>
        <span class="tag" data-filter="new">Baru</span>
        <span class="tag" data-filter="sale">Diskon</span>
      </div>
    </div>
    <div class="product-grid" id="grid"></div>
  </main>

  <button class="dark-toggle" id="themeToggle">ðŸŒ™</button>

  <script>
    // utilities
    function fmtRp(v){ return "Rp " + v.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."); }
    const PROD_KEY="sigit_products";
    const CART_KEY="sigit_cart";

    function loadProducts(){ try{ return JSON.parse(localStorage.getItem(PROD_KEY)||"[]"); }catch{ return []; } }
    function saveCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); }
    function loadCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY)||"[]"); }catch{return [];} }
    function updateCartBtn(){ const tot=loadCart().reduce((s,i)=>s+i.qty,0); document.getElementById("cartBtn").textContent=`Keranjang (${tot})`; }

    function render(filterText="", filterTag="all"){
      const grid=document.getElementById("grid");
      grid.innerHTML="";
      const all=loadProducts();
      const ft=filterText.trim().toLowerCase();
      const filtered=all.filter(p=>{
        const matchText = p.name.toLowerCase().includes(ft) || (p.desc && p.desc.toLowerCase().includes(ft));
        const matchTag = filterTag==="all" || p.tag===filterTag;
        return matchText && matchTag;
      });
      if(filtered.length===0){
        grid.innerHTML='<div style="grid-column:1/-1;text-align:center;">Tidak ada produk.</div>';
        return;
      }
      filtered.forEach(p=>{
        const card=document.createElement("div");
        card.className="card";
        card.innerHTML=`
          <div style="position:relative;">
            ${p.tag==="new"?'<div style="position:absolute;top:8px;right:8px;background:#10b981;color:#fff;padding:4px 10px;border-radius:999px;font-size:.55rem;">Baru</div>':''}
            <img src="${p.image||''}" alt="${p.name}" width="100%" height="160" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22160%22><rect width=%22200%22 height=%22160%22 fill=%23ececec/></svg>';" />
          </div>
          <div style="flex:1;display:flex;flex-direction:column;gap:6px;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div><strong>${p.name}</strong></div>
              ${p.tag==="sale"?'<div style="background:#ff6b6b;color:#fff;padding:4px 8px;border-radius:6px;font-size:.55rem;">Diskon</div>':''}
            </div>
            <div class="price">${fmtRp(p.price)}</div>
            <div class="small">${p.desc||''}</div>
            <div style="margin-top:auto;">
              <button class="btn" data-id="${p.id}">Tambah ke Keranjang</button>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
      document.querySelectorAll('[data-id]').forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const id=parseInt(btn.getAttribute("data-id"));
          const prod=loadProducts().find(p=>p.id===id);
          if(!prod) return;
          let cart=loadCart();
          const idx=cart.findIndex(i=>i.id===id);
          if(idx===-1) cart.push({...prod, qty:1});
          else cart[idx].qty +=1;
          saveCart(cart);
          updateCartBtn();
          btn.textContent="âœ“"; setTimeout(()=>{ btn.textContent="Tambah ke Keranjang"; },800);
        });
      });
    }

    // filters/search
    document.querySelectorAll('.tag').forEach(t=>{
      t.addEventListener("click", ()=> {
        document.querySelectorAll('.tag').forEach(x=>x.style.opacity="1");
        t.style.opacity="0.6";
        render(document.getElementById("search").value, t.getAttribute("data-filter"));
      });
    });
    document.getElementById("search").addEventListener("input", ()=>{
      render(document.getElementById("search").value, "all");
    });

    // dark mode
    const toggle=document.getElementById("themeToggle");
    function setTheme(t){ document.body.setAttribute("data-theme", t); toggle.textContent=t==="dark"?"ðŸŒž":"ðŸŒ™"; localStorage.setItem("theme", t); }
    toggle.addEventListener("click", ()=>{ setTheme(document.body.getAttribute("data-theme")==="dark"?"light":"dark"); });
    const saved=localStorage.getItem("theme");
    if(saved) setTheme(saved);

    // bootstrap sample if empty
    if(loadProducts().length===0){
      const sample=[
        {id:1,name:"Kacamata Stylish",price:129000,tag:"new",desc:"Frame modern.",image:""},
        {id:2,name:"Headset Gaming RGB",price:349000,tag:"sale",desc:"RGB + noise-cancel.",image:""},
        {id:3,name:"Tas Ransel Anti Air",price:229000,tag:"all",desc:"Tahan lama.",image:""}
      ];
      localStorage.setItem(PROD_KEY, JSON.stringify(sample));
    }

    // init
    render();
    updateCartBtn();
  </script>
</body>
</html>